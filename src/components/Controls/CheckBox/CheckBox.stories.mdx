import { Meta, Story, Preview, Props } from '@storybook/addon-docs';
import { withKnobs, boolean, select, text } from '@storybook/addon-knobs';
import CheckBox from './CheckBox';
import Stack from '../../storyUtils/Stack';
import { FIGMA_URL, Function } from '../../../utils/common';
import { useState, useEffect } from 'react';
import Overview from '../../../storybook/Overview';

<Meta
  title="Updated Components/Controls/CheckBox"
  component={CheckBox}
  parameters={{
    design: [
      {
        type: 'figma',
        name: 'CheckBox',
        url: `${FIGMA_URL}?node-id=228%3A143`,
      },
    ],
  }}
/>

<SectionHeader title={'CheckBox'} />

- [Overview](#overview)
- [Props](#props)
- [Usage](#usage)
- [Variants](#variants)

## Overview

<Story
  name="Overview"
  parameters={{
    previewTabs: {
      canvas: { hidden: true },
    },
  }}
>
  <Overview>A component that allows the user to select one or more items from a set.</Overview>
</Story>

## Props

<Props of={CheckBox} />

## Usage

<UsageGuidelines
  guidelines={['Use if you have multiple options and need to select 1+ items.']}
  policies={[
    'If you can select exactly 1 items use radio buttons',
    'If you can select exactly 1 item from the multiple options, use radio buttons',
  ]}
/>

<SubsectionHeader title="Variants" />

### Simple CheckBox

<Preview>
  <Story name="Simple CheckBox">
    <Stack height={50}>
      <Function>
        {() => {
          const [selected, setSelected] = useState(false);
          return (
            <CheckBox value="label" isSelected={selected} onChange={setSelected}>
              Label
            </CheckBox>
          );
        }}
      </Function>
    </Stack>
  </Story>
</Preview>

### Indeterminate CheckBox

<Preview>
  <Story name="Indeterminate CheckBox">
    <Stack height={140}>
      <Function>
        {() => {
          const [selected, setSelected] = useState(false);
          const [indeterminate, setIndeterminate] = useState(false);
          const [selected1, setSelected1] = useState(false);
          const [selected2, setSelected2] = useState(false);
          useEffect(() => {
            if ((selected1 && !selected2) || (!selected1 && selected2)) {
              setSelected(false);
              setIndeterminate(true);
            }
            if (selected1 && selected2) {
              setIndeterminate(false);
              setSelected(true);
            }
            if (!(selected1 || selected2)) {
              setSelected(false);
              setIndeterminate(false);
            }
          }, [selected1, selected2]);
          return (
            <div style={{ display: 'flex', flexDirection: 'column', gap: '32px' }}>
              <div>
                <CheckBox
                  value="select all"
                  isSelected={selected}
                  isIndeterminate={indeterminate}
                  onChange={(value) => {
                    setSelected1(value);
                    setSelected2(value);
                  }}
                >
                  Select All
                </CheckBox>
              </div>
              <div style={{ display: 'flex', flexDirection: 'column', gap: '24px' }}>
                <CheckBox value="option 1" isSelected={selected1} onChange={setSelected1}>
                  Option 1
                </CheckBox>
                <CheckBox value="option 2" isSelected={selected2} onChange={setSelected2}>
                  Option 2
                </CheckBox>
              </div>
            </div>
          );
        }}
      </Function>
    </Stack>
  </Story>
</Preview>

### CheckBox label placement

Label can be placed either `left` or `right` of the checkbox.

<Tip>
  The labelConfig prop of each CheckBox includes an sx prop in order to add custom styles on the
  container that wraps the checkbox input and the label
</Tip>

<Preview>
  <Story name="CheckBox label placement">
    <Stack height={50}>
      <CheckBox value="label">Option</CheckBox>
    </Stack>
    <Stack>
      <CheckBox value="label" labelConfig={{ placement: 'left' }}>
        Option
      </CheckBox>
    </Stack>
  </Story>
</Preview>

### CheckBox label sizes

Label can be either a string or a custom component. In the case of the string, there are 2 sizes (declared inside the labelConfig), `normal` and `large`

<Preview>
  <Story name="CheckBox label sizes">
    <Stack height={50}>
      <CheckBox value="label">Normal Option</CheckBox>
    </Stack>
    <Stack>
      <CheckBox value="label" labelConfig={{ size: 'large' }}>
        Large Option
      </CheckBox>
    </Stack>
  </Story>
</Preview>

### CheckBox label helptext

CheckBox can include a helptext under the label.

<Preview>
  <Story name="CheckBox label helptext">
    <Stack>
      <CheckBox value="label" labelConfig={{ helpText: 'This is the helptext of the option' }}>
        Option
      </CheckBox>
    </Stack>
  </Story>
</Preview>

### Disabled CheckBox

<Preview>
  <Story name="Disabled CheckBox">
    <Stack height={50}>
      <CheckBox value="label" isDisabled>
        Option
      </CheckBox>
    </Stack>
    <Stack>
      <CheckBox value="label" labelConfig={{ helpText: 'This option is disabled' }} isDisabled>
        Option
      </CheckBox>
    </Stack>
  </Story>
</Preview>

### Playground

<Preview>
  <Story name="Playground" parameters={{ decorators: [withKnobs] }}>
    <Stack>
      <CheckBox
        value="label"
        isSelected={boolean('isSelected', false)}
        isIndeterminate={boolean('isIndeterminate', false)}
        labelConfig={{
          placement: select('Label placement', ['left', 'right'], 'right'),
          size: select('Label size', ['normal', 'large'], 'normal'),
          helpText: text('Help text', ''),
        }}
        isDisabled={boolean('isDisabled', false)}
      >
        Option
      </CheckBox>
    </Stack>
  </Story>
</Preview>
