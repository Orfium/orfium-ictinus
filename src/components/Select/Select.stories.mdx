import { Meta, Story, Preview, Props } from '@storybook/addon-docs';
import { withKnobs, boolean, array, select, text } from '@storybook/addon-knobs';
import Select from './Select';
import Stack from '../storyUtils/Stack';
import { SelectShowcase, MultiSelectShowcase } from '../storyUtils/SelectShowcase';
import EdgeCasesSelectShowcase from '../storyUtils/EdgeCasesSelectShowcase';
import Typography from '../Typography';
import { FIGMA_URL, Function } from '../../utils/common';
import { useState } from 'react';
import { StatefulSelect } from './index';
import SectionHeader from '../../storybook/SectionHeader';
const options = [
  { value: 'chocolate', label: 'Chocolate' },
  { value: 'strawberry', label: 'Strawberry' },
  { value: 'banana', label: 'Banana' },
  { value: 'citrus2', label: 'Citrus2' },
  { value: 'citrus3', label: 'Citrus3' },
  { value: 'citrus4', label: 'Citrus4' },
  { value: 'vanilla', label: 'Vanilla', isDisabled: true },
];
const optionsWithHelperInDisabled = [
  { value: 'chocolate', label: 'Chocolate' },
  { value: 'strawberry', label: 'Strawberry' },
  { value: 'banana', label: 'Banana' },
  { value: 'citrus', label: 'Citrus' },
  { value: 'why_Disabled', label: 'Why Disabled?', helperText: 'this is why!', isDisabled: true },
];
const groupOptions = [
  {
    value: 'Sweet',
    label: 'Sweets',
    options: [
      { value: '1', label: 'Chocolate' },
      { value: '2', label: 'Option 2' },
    ],
  },
  {
    value: 'Sour',
    label: 'Sour',
    options: [{ value: '3', label: 'Option 3' }],
  },
  { value: '4', label: 'Option 4' },
  {
    value: 'group5',
    label: 'Group 5',
    options: [
      { value: '5', label: 'Option 7' },
      { value: '6', label: 'Option 8' },
    ],
  },
  {
    value: 'group6',
    label: 'Group 6',
    options: [{ value: '7', label: 'Option 9' }],
  },
];
const defaultValue = options[0];

<Meta
  title="Design System/Select"
  component={Select}
  parameters={{
    design: [
      {
        type: 'figma',
        name: 'Select',
        url: `${FIGMA_URL}?node-id=10019%3A116506`,
      },
      {
        type: 'figma',
        name: 'Active',
        url: `${FIGMA_URL}?node-id=10019%3A116507`,
      },
      {
        type: 'figma',
        name: 'Edge cases',
        url: `${FIGMA_URL}?node-id=1879%3A101`,
      },
    ],
  }}
/>

<SectionHeader title={'Select'} />

- [Overview](#overview)
- [Props](#props)
- [Usage](#usage)
- [Variants](#variants)

## Overview

<Story
  name="Overview"
  parameters={{
    previewTabs: {
      canvas: { hidden: true },
    },
  }}
>
  <Typography>
    A universal Select component that is a clickable element that can hold many forms.
  </Typography>
</Story>

## Usage

<UsageGuidelines
  guidelines={[
    'If you need to select and enter an item from a dropdown list that features more than seven items, use searchable select instead. This is the default prop.',
    'If you need to be able to enter free text entry in addition to choosing form a predefined list, use searchable select instead',
    'If you need to enter more than one values from a predefined list, use multiselect instead',
    `If you need to enter more than one values from a predefine list and as free text, use multiselect instead`,
  ]}
/>

## Props

<Props of={Select} />

## Variants

### Simple Select

Simple select component with clearable data and searchable input

<Preview>
  <Story name="Simple Select">
    <Stack height={300}>
      <Function>
        {() => {
          const [selectedOption, setSelectedOption] = useState(defaultValue);
          return (
            <Select
              label={'Flavour'}
              options={options}
              selectedOption={selectedOption}
              onChange={setSelectedOption}
              isCreatable={boolean('isCreatable', false)}
              isVirtualized={boolean('isVirtualized', true)}
            />
          );
        }}
      </Function>
      <Function>
        {() => {
          const [selectedOption, setSelectedOption] = useState(defaultValue);
          return (
            <Select
              label={'Flavour'}
              options={options}
              selectedOption={selectedOption}
              onChange={setSelectedOption}
              isCreatable={boolean('isCreatable', false)}
            />
          );
        }}
      </Function>
      <Function>
        {() => {
          const [selectedOption, setSelectedOption] = useState(defaultValue);
          return (
            <Select
              label={'Flavour'}
              options={options}
              selectedOption={selectedOption}
              onChange={setSelectedOption}
              isCreatable={boolean('isCreatable', false)}
            />
          );
        }}
      </Function>
    </Stack>
  </Story>
</Preview>

### Select with Statuses

Select with Statuses

<Preview>
  <Story name="Select with Statuses" parameters={{ decorators: [withKnobs] }}>
    <Stack height={350}>
      <Function>
        {() => {
          const [selectedOption, setSelectedOption] = useState(defaultValue);
          return (
            <Select
              label={'Normal'}
              status={{
                type: 'normal',
                hintMessage: text('Custom Hint Message', 'Hint Message'),
              }}
              options={options}
              selectedOption={selectedOption}
              onChange={setSelectedOption}
              isCreatable={boolean('isCreatable', false)}
              isVirtualized={boolean('isVirtualized', true)}
            />
          );
        }}
      </Function>
      <Function>
        {() => {
          const [selectedOption, setSelectedOption] = useState(defaultValue);
          return (
            <Select
              label={'Error'}
              status={{
                type: 'error',
                hintMessage: text('Custom Error Message', 'Error Message'),
              }}
              options={options}
              selectedOption={selectedOption}
              onChange={setSelectedOption}
              isCreatable={boolean('isCreatable', false)}
              isVirtualized={boolean('isVirtualized', true)}
            />
          );
        }}
      </Function>
      <Function>
        {() => {
          const [selectedOption, setSelectedOption] = useState(defaultValue);
          return (
            <Select
              label={'Read-only'}
              status={{
                type: 'read-only',
                hintMessage: text('Custom Hint Message', 'Hint Message'),
              }}
              options={options}
              selectedOption={selectedOption}
              onChange={setSelectedOption}
              isCreatable={boolean('isCreatable', false)}
              isVirtualized={boolean('isVirtualized', true)}
            />
          );
        }}
      </Function>
    </Stack>
  </Story>
</Preview>

### Select with uncontrolled state

Select with uncontrolled state

<Preview>
  <Story name="Select with uncontrolled state" parameters={{ decorators: [withKnobs] }}>
    <Stack height={350}>
      <StatefulSelect
        label={'Label'}
        status={{
          type: 'normal',
          hintMessage: text(
            'Custom Hint Message',
            'This is a select with uncontrolled value, see code for more'
          ),
        }}
        options={options}
        selectedOption={defaultValue}
      />
    </Stack>
  </Story>
</Preview>

### Select with Highlighted search term

Simple select component where searched term is highlighted in options

<Preview>
  <Story name="Select with Highlight">
    <Stack height={350}>
      <Function>
        {() => {
          const [selectedOption, setSelectedOption] = useState(defaultValue);
          return (
            <Select
              hasHighlightSearch
              selectedOption={selectedOption}
              onChange={setSelectedOption}
              label={'Flavour'}
              options={options}
            />
          );
        }}
      </Function>
    </Stack>
  </Story>
</Preview>

### Simple Group Select

Simple select component with grouped data and searchable input

<Preview>
  <Story name="Simple Group Select">
    <Stack height={350}>
      <Function>
        {() => {
          const [selectedOption, setSelectedOption] = useState(defaultValue);
          return (
            <Select
              label={'Group Select'}
              hasHighlightSearch
              selectedOption={selectedOption}
              onChange={setSelectedOption}
              options={groupOptions}
            />
          );
        }}
      </Function>
    </Stack>
  </Story>
</Preview>

### Not Searchable Select

Not Searchable Select

<Preview>
  <Story name="Not Searchable Select">
    <Stack height={350}>
      <Function>
        {() => {
          const [selectedOption, setSelectedOption] = useState(defaultValue);
          return (
            <Select
              isSearchable={false}
              selectedOption={selectedOption}
              onChange={setSelectedOption}
              label={'Flavour'}
              options={options}
            />
          );
        }}
      </Function>
    </Stack>
  </Story>
</Preview>

### Disabled Select

Select disabled with label

<Preview>
  <Story name="Disabled Select">
    <Stack>
      <Select
        isDisabled
        label={'Label'}
        options={options}
        status={{ type: 'normal', hintMessage: 'This field is disabled' }}
      />
    </Stack>
  </Story>
</Preview>

### Disabled option with helper text

Disabled option with helper text

<Preview>
  <Story name="Disabled option with helper text">
    <Stack height={350}>
      <Function>
        {() => {
          const [selectedOption, setSelectedOption] = useState(defaultValue);
          return (
            <Select
              isSearchable={false}
              selectedOption={selectedOption}
              onChange={setSelectedOption}
              label={'Flavour'}
              options={optionsWithHelperInDisabled}
            />
          );
        }}
      </Function>
    </Stack>
  </Story>
</Preview>

### Select with Async and Loading

Select that support asynchronous fetching, with loading status

<Preview>
  <Story name="Async Select">
    <SelectShowcase />
  </Story>
</Preview>

### Select with Async, Loading and Minimum Characters to Search for

Select that support asynchronous fetching, with loading status

<Preview>
  <Story name="Async Select with min characters">
    <SelectShowcase minCharactersToSearch={3} />
  </Story>
</Preview>

### Select with edge case

Select cases where it gets to minimum and maximum width based on options <br />

1. max width of floating menu to 620 and then ellipsis <br />
2. max width with smaller floating menu content that set to max
3. min size (150px) for both

<Preview>
  <Story name="Select with edge case">
    <EdgeCasesSelectShowcase />
  </Story>
</Preview>

### MultiSelect

A Select component with multiple selected options represented as Chips. <br/>

_. To initiate a MultiSelect, the `multi` prop must be set to `true`
_. In this variation the props: `leftIcon` and `size` are deprecated (`size` is always set to `md` by default). <br/>
_. Instead of the `selectedOption` prop we now use the `selectedOptions` prop (with type: `SelectOption[]`) .
_. When in MultiSelect, `onClear` prop refers to the all selected options deletion and `onOptionDelete` prop refers to single option deletion

<Preview>
  <Story name="MultiSelect">
    <MultiSelectShowcase
      isDisabled={boolean('isDisabled', false)}
      status={{
        type: select('Status', ['error', 'normal', 'read-only'], 'normal'),
        hintMessage: text('Hint/Error message', 'Message in Text Field'),
      }}
      hasSelectAllOption={boolean('hasSelectAllOption', false)}
      isCreatable={boolean('isCreatable', false)}
    />
  </Story>
</Preview>
